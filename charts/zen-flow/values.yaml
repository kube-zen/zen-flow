# Default values for zen-flow
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: kubezen/zen-flow-controller
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: "0.0.1-alpha"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 65534
  fsGroup: 65534
  seccompProfile:
    type: RuntimeDefault

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true

service:
  type: ClusterIP
  port: 8080
  webhookPort: 443
  targetPort: 8080
  webhookTargetPort: 9443

resources:
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  limits:
    cpu: 500m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 64Mi

nodeSelector: {}

tolerations: []

affinity: {}

# Leader election configuration
leaderElection:
  enabled: true
  namespace: ""

# Webhook configuration
webhook:
  # Disabled by default for safe installation without prerequisites
  # Enable only if you have cert-manager or will provide TLS certificates manually
  enabled: false
  port: 9443
  certFile: /etc/webhook/certs/tls.crt
  keyFile: /etc/webhook/certs/tls.key
  # Certificate secret name (managed by cert-manager if using webhook.certManager)
  certSecret: zen-flow-webhook-cert
  # Failure policy: Ignore (safe default) or Fail (requires valid TLS)
  # Ignore allows resource creation even if webhook is unreachable
  failurePolicy: Ignore
  # Use cert-manager to manage certificates
  certManager:
    enabled: false
    issuer:
      name: ""
      kind: ClusterIssuer  # ClusterIssuer or Issuer

# Metrics configuration
metrics:
  enabled: true
  port: 8080
  serviceMonitor:
    enabled: false
    interval: 30s
    scrapeTimeout: 10s
    labels: {}

# Prometheus rules
prometheus:
  rules:
    enabled: false

# Grafana dashboard
grafana:
  dashboard:
    enabled: false

# CRD management
crd:
  # Install CRDs as part of Helm install
  install: true

# Namespace configuration
namespace:
  create: true
  name: zen-flow-system

# Additional environment variables
env: []
  # - name: CUSTOM_VAR
  #   value: "custom-value"

# Additional volume mounts
extraVolumeMounts: []

# Additional volumes
extraVolumes: []

# Liveness and readiness probes
livenessProbe:
  httpGet:
    path: /healthz
    port: 8080
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /readyz
    port: 8080
  initialDelaySeconds: 5
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3

# Controller configuration
controller:
  maxConcurrentReconciles: 10
  resyncPeriod: "10m"

